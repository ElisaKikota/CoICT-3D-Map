[[headers]]
for = "/unity/index.html"
  [headers.values]
  Content-Type = "text/html"

[[headers]]
for = "/unity/Build/*"
  [headers.values]
  Cross-Origin-Resource-Policy = "cross-origin"
  Cache-Control = "public, max-age=31536000, immutable"

[[headers]]
for = "/unity/*.data*"
  [headers.values]
  Content-Type = "application/octet-stream"

[[headers]]
for = "/unity/*.unityweb"
  [headers.values]
  Content-Type = "application/octet-stream"
  Cache-Control = "public, max-age=31536000, immutable"

[[headers]]
for = "/unity/*.wasm*"
  [headers.values]
  Content-Type = "application/wasm"
  Cache-Control = "public, max-age=31536000, immutable"

[[headers]]
for = "/unity/*.js*"
  [headers.values]
  Content-Type = "application/javascript"
  Cache-Control = "public, max-age=31536000, immutable"

[[headers]]
for = "/unity/Build/*.js*"
  [headers.values]
  Content-Type = "application/javascript"
  Cache-Control = "public, max-age=31536000, immutable"

[[headers]]
for = "/unity/Build/CoICT3DMap.framework.js"
  [headers.values]
  Content-Type = "application/javascript"
  Cache-Control = "public, max-age=31536000, immutable"

[[headers]]
for = "/unity/Build/CoICT3DMap.loader.js"
  [headers.values]
  Content-Type = "application/javascript"
  Cache-Control = "public, max-age=31536000, immutable"

[build]
  command = "npm run build"
  publish = "dist"

# Redirect all routes to index.html for React SPA routing
# force = false means: only redirect if the file doesn't exist
# This allows Unity files and other static assets to be served correctly
[[redirects]]
  from = "/*"
  to = "/index.html"
  status = 200
  force = false
  conditions = {Role = ["!admin"]}

# Ensure Unity files are served correctly
[[redirects]]
  from = "/unity/*"
  to = "/unity/:splat"
  status = 200
  force = true


